





from __future__ import with_statement



try:
    import annotation
except ImportError:
    import os.path
    from sys import path as sys_path
    
    sys_path.append(os.path.join(os.path.dirname(__file__), '../server/src'))
    import annotation

try:
    import argparse
except ImportError:
    import os.path
    from sys import path as sys_path
    
    sys_path.append(os.path.join(os.path.dirname(__file__), '../server/lib'))
    import argparse


sys_path.append(os.path.join(os.path.dirname(__file__), '..'))





class Mapping: 
    def __init__(self):
        self.first_by_second = dict()
        self.second_by_first = dict()
        self.only_in_second = []
    def add(self, first, second, is_clone=False):
        self.first_by_second[second] = first
        self.second_by_first[first] = second
        if is_clone:
            self.only_in_second.append(second)
    def get_second(self, first):
        return self.second_by_first[first] if first in self.second_by_first else None
    def get_first(self, second):
        return self.first_by_second[second] if second in self.first_by_second else None
    def is_only_in_second(self, second):
        return second in self.only_in_second
    def is_only_in_first(self, first):
        return first in self.second_by_first



class AnnotationDiff: 
    def __init__(self, first, second, result): 
        self.first = first
        self.second = second
        self.result = result
        self.mapping = Mapping()
        self.first_textbounds = dict((textbound.id, textbound) for textbound in first.get_textbounds())
    

    def diff(self): 
        

        self.diff_entities()
        self.diff_triggers()
        self.diff_events()
        self.diff_oneline_comments()
        self.diff_equivs()
        self.diff_normalizations()
        self.diff_attributes()
        self.diff_relations()
    


    
    def add_mark(self, type, target, reason):
        comment = annotation.OnelineCommentAnnotation(
                target,
                self.result.get_new_id('#'),
                type,
                "\"t"" ""+"" ""r""e""a""s""o""n"")""
"" "" "" "" "" "" "" "" ""s""e""l""f"".""r""e""s""u""l""t"".""a""d""d""_""a""n""n""o""t""a""t""i""o""n""(""c""o""m""m""e""n""t"")""
""
"" "" "" "" ""d""e""f"" ""a""d""d""_""m""i""s""s""i""n""g""(""s""e""l""f"","" ""t""a""r""g""e""t"","" ""r""e""a""s""o""n"")"":""
"" "" "" "" "" "" "" "" ""s""e""l""f"".""a""d""d""_""m""a""r""k""(""'""M""i""s""s""i""n""g""A""n""n""o""t""a""t""i""o""n""'"","" ""t""a""r""g""e""t"","" ""r""e""a""s""o""n"")""
""
"" "" "" "" ""d""e""f"" ""a""d""d""_""a""d""d""e""d""(""s""e""l""f"","" ""t""a""r""g""e""t"","" ""r""e""a""s""o""n"")"":""
"" "" "" "" "" "" "" "" ""s""e""l""f"".""a""d""d""_""m""a""r""k""(""'""A""d""d""e""d""A""n""n""o""t""a""t""i""o""n""'"","" ""t""a""r""g""e""t"","" ""r""e""a""s""o""n"")""
""
"" "" "" "" ""d""e""f"" ""a""d""d""_""c""h""a""n""g""e""d""(""s""e""l""f"","" ""t""a""r""g""e""t"","" ""r""e""a""s""o""n"")"":""
"" "" "" "" "" "" "" "" ""s""e""l""f"".""a""d""d""_""m""a""r""k""(""'""C""h""a""n""g""e""d""A""n""n""o""t""a""t""i""o""n""'"","" ""t""a""r""g""e""t"","" ""r""e""a""s""o""n"")""
"" "" "" "" ""#"" ""}""}""}""
""
""
"" "" "" "" ""#"" ""E""n""t""i""t""i""e""s"" ""{""{""{""
"" "" "" "" ""d""e""f"" ""f""i""n""d""_""e""n""t""i""t""y""(""s""e""l""f"","" ""h""a""y""s""t""a""c""k"","" ""n""e""e""d""l""e"")"":""
"" "" "" "" "" "" "" "" ""f""o""r"" ""e""n""t""i""t""y"" ""i""n"" ""h""a""y""s""t""a""c""k"".""g""e""t""_""e""n""t""i""t""i""e""s""("")"":""
"" "" "" "" "" "" "" "" "" "" "" "" ""i""f"" ""e""n""t""i""t""y"".""s""a""m""e""_""s""p""a""n""(""n""e""e""d""l""e"")"" ""a""n""d"" ""e""n""t""i""t""y"".""t""y""p""e"" ""=""="" ""n""e""e""d""l""e"".""t""y""p""e"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""r""e""t""u""r""n"" ""e""n""t""i""t""y""
"" "" "" "" "" "" "" "" ""r""e""t""u""r""n"" ""N""o""n""e""
""
"" "" "" "" ""d""e""f"" ""d""i""f""f""_""e""n""t""i""t""i""e""s""(""s""e""l""f"")"":""
"" "" "" "" "" "" "" "" ""f""o""u""n""d""_""f""i""r""s""t""_""i""d""s"" ""="" ""s""e""t""("")""
""
"" "" "" "" "" "" "" "" ""f""o""r"" ""e""n""t""i""t""y"" ""i""n"" ""s""e""l""f"".""s""e""c""o""n""d"".""g""e""t""_""e""n""t""i""t""i""e""s""("")"":""
"" "" "" "" "" "" "" "" "" "" "" "" ""f""o""u""n""d""_""f""i""r""s""t"" ""="" ""s""e""l""f"".""f""i""n""d""_""e""n""t""i""t""y""(""s""e""l""f"".""f""i""r""s""t"","" ""e""n""t""i""t""y"")""
"" "" "" "" "" "" "" "" "" "" "" "" ""i""f"" ""f""o""u""n""d""_""f""i""r""s""t"" ""i""s"" ""N""o""n""e"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""s""e""l""f"".""a""d""d""_""a""d""d""e""d""(""e""n""t""i""t""y"".""i""d"","" ""'""A""d""d""e""d"" ""e""n""t""i""t""y""'"")""
"" "" "" "" "" "" "" "" "" "" "" "" ""e""l""s""e"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""f""o""u""n""d""_""f""i""r""s""t""_""i""d""s"".""a""d""d""(""f""o""u""n""d""_""f""i""r""s""t"".""i""d"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""s""e""l""f"".""m""a""p""p""i""n""g"".""a""d""d""(""f""o""u""n""d""_""f""i""r""s""t"".""i""d"","" ""e""n""t""i""t""y"".""i""d"")""
"" "" "" "" "" "" "" "" ""i""m""p""o""r""t"" ""c""o""p""y""
"" "" "" "" "" "" "" "" ""f""o""r"" ""e""n""t""i""t""y"" ""i""n"" ""s""e""l""f"".""f""i""r""s""t"".""g""e""t""_""e""n""t""i""t""i""e""s""("")"":""
"" "" "" "" "" "" "" "" "" "" "" "" ""i""f"" ""n""o""t"" ""e""n""t""i""t""y"".""i""d"" ""i""n"" ""f""o""u""n""d""_""f""i""r""s""t""_""i""d""s"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""c""l""o""n""e"" ""="" ""c""o""p""y"".""c""o""p""y""(""e""n""t""i""t""y"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""c""l""o""n""e"".""i""d"" ""="" ""s""e""l""f"".""r""e""s""u""l""t"".""g""e""t""_""n""e""w""_""i""d""(""'""T""'"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""s""e""l""f"".""r""e""s""u""l""t"".""a""d""d""_""a""n""n""o""t""a""t""i""o""n""(""c""l""o""n""e"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""s""e""l""f"".""m""a""p""p""i""n""g"".""a""d""d""(""e""n""t""i""t""y"".""i""d"","" ""c""l""o""n""e"".""i""d"","" ""T""r""u""e"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""s""e""l""f"".""a""d""d""_""m""i""s""s""i""n""g""(""c""l""o""n""e"".""i""d"","" ""'""M""i""s""s""i""n""g"" ""e""n""t""i""t""y""'"")""
"" "" "" "" ""#"" ""}""}""}""
""
""
"" "" "" "" ""#"" ""T""r""i""g""g""e""r""s"" ""{""{""{""
"" "" "" "" ""d""e""f"" ""f""i""n""d""_""t""r""i""g""g""e""r""(""s""e""l""f"","" ""h""a""y""s""t""a""c""k"","" ""n""e""e""d""l""e"")"":""
"" "" "" "" "" "" "" "" ""f""o""r"" ""t""r""i""g""g""e""r"" ""i""n"" ""h""a""y""s""t""a""c""k"".""g""e""t""_""t""r""i""g""g""e""r""s""("")"":""
"" "" "" "" "" "" "" "" "" "" "" "" ""i""f"" ""t""r""i""g""g""e""r"".""s""a""m""e""_""s""p""a""n""(""n""e""e""d""l""e"")"" ""a""n""d"" ""t""r""i""g""g""e""r"".""t""y""p""e"" ""=""="" ""n""e""e""d""l""e"".""t""y""p""e"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""r""e""t""u""r""n"" ""t""r""i""g""g""e""r""
"" "" "" "" "" "" "" "" ""r""e""t""u""r""n"" ""N""o""n""e""
""
"" "" "" "" ""d""e""f"" ""d""i""f""f""_""t""r""i""g""g""e""r""s""(""s""e""l""f"")"":""
"" "" "" "" "" "" "" "" ""f""o""u""n""d""_""f""i""r""s""t""_""i""d""s"" ""="" ""s""e""t""("")""
""
"" "" "" "" "" "" "" "" ""f""o""r"" ""t""r""i""g""g""e""r"" ""i""n"" ""s""e""l""f"".""s""e""c""o""n""d"".""g""e""t""_""t""r""i""g""g""e""r""s""("")"":""
"" "" "" "" "" "" "" "" "" "" "" "" ""f""o""u""n""d""_""f""i""r""s""t"" ""="" ""s""e""l""f"".""f""i""n""d""_""t""r""i""g""g""e""r""(""s""e""l""f"".""f""i""r""s""t"","" ""t""r""i""g""g""e""r"")""
"" "" "" "" "" "" "" "" "" "" "" "" ""i""f"" ""f""o""u""n""d""_""f""i""r""s""t"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""f""o""u""n""d""_""f""i""r""s""t""_""i""d""s"".""a""d""d""(""f""o""u""n""d""_""f""i""r""s""t"".""i""d"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""s""e""l""f"".""m""a""p""p""i""n""g"".""a""d""d""(""f""o""u""n""d""_""f""i""r""s""t"".""i""d"","" ""t""r""i""g""g""e""r"".""i""d"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""#"" ""n""o"" ""`""e""l""s""e""`"";"" ""t""h""e"" ""c""o""m""m""e""n""t""s"" ""a""r""e"" ""h""a""n""d""l""e""d"" ""b""y"" ""d""i""f""f""_""e""v""e""n""t""s""("")"";""
"" "" "" "" "" "" "" "" ""i""m""p""o""r""t"" ""c""o""p""y""
"" "" "" "" "" "" "" "" ""f""o""r"" ""t""r""i""g""g""e""r"" ""i""n"" ""s""e""l""f"".""f""i""r""s""t"".""g""e""t""_""t""r""i""g""g""e""r""s""("")"":""
"" "" "" "" "" "" "" "" "" "" "" "" ""i""f"" ""n""o""t"" ""t""r""i""g""g""e""r"".""i""d"" ""i""n"" ""f""o""u""n""d""_""f""i""r""s""t""_""i""d""s"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""c""l""o""n""e"" ""="" ""c""o""p""y"".""c""o""p""y""(""t""r""i""g""g""e""r"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""c""l""o""n""e"".""i""d"" ""="" ""s""e""l""f"".""r""e""s""u""l""t"".""g""e""t""_""n""e""w""_""i""d""(""'""T""'"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""s""e""l""f"".""r""e""s""u""l""t"".""a""d""d""_""a""n""n""o""t""a""t""i""o""n""(""c""l""o""n""e"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""s""e""l""f"".""m""a""p""p""i""n""g"".""a""d""d""(""t""r""i""g""g""e""r"".""i""d"","" ""c""l""o""n""e"".""i""d"","" ""T""r""u""e"")""
"" "" "" "" ""#"" ""}""}""}""
"" "" "" "" ""
""
"" "" "" "" ""#"" ""E""v""e""n""t""s"" ""{""{""{""
"" "" "" "" ""#""
"" "" "" "" ""#"" ""E""v""e""n""t""s"" ""a""r""e"" ""a"" ""p""r""o""b""l""e""m"","" ""s""i""n""c""e"" ""t""h""e""r""e"" ""c""a""n"" ""b""e"" ""m""u""l""t""i""p""l""e"" ""e""v""e""n""t""s"" ""f""o""r"" ""t""h""e""
"" "" "" "" ""#"" ""s""a""m""e"" ""t""r""i""g""g""e""r"" ""w""h""i""c""h"" ""a""r""e"" ""o""n""l""y"" ""d""i""s""t""i""n""g""u""i""s""h""e""d"" ""b""y"" ""t""h""e""i""r"" ""a""r""g""u""m""e""n""t""s"".""
"" "" "" "" ""#"" ""A""n"" ""a""d""d""i""t""i""o""n""a""l"" ""p""r""o""b""l""e""m"" ""i""s"" ""t""h""a""t"" ""a""r""g""u""m""e""n""t""s"" ""c""a""n"" ""a""l""s""o"" ""b""e"" ""e""v""e""n""t""s"","" ""s""o"" ""w""e""
"" "" "" "" ""#"" ""d""o""n""'""t"" ""n""e""c""e""s""s""a""r""i""l""y"" ""k""n""o""w"" ""t""h""e"" ""m""a""p""p""i""n""g"" ""o""f"" ""t""h""e"" ""a""r""g""u""m""e""n""t""s"".""
"" "" "" "" ""#"" ""T""h""u""s"","" ""w""h""e""n"" ""c""o""m""p""a""r""i""n""g"" ""e""v""e""n""t""s""-""a""s""-""a""r""g""u""m""e""n""t""s"","" ""w""e"" ""c""o""m""p""a""r""e"" ""o""n""l""y"" ""t""h""e""i""r""
"" "" "" "" ""#"" ""t""r""i""g""g""e""r""s"".""
"" "" "" "" ""d""e""f"" ""t""r""i""g""g""e""r""_""o""r""_""s""e""l""f""(""s""e""l""f"","" ""t""a""r""g""e""t"","" ""t""r""i""g""g""e""r""s"")"":""
"" "" "" "" "" "" "" "" ""t""r""y"":""
"" "" "" "" "" "" "" "" "" "" "" "" ""r""e""t""u""r""n"" ""t""r""i""g""g""e""r""s""[""t""a""r""g""e""t""]""
"" "" "" "" "" "" "" "" ""e""x""c""e""p""t"" ""K""e""y""E""r""r""o""r"":""
"" "" "" "" "" "" "" "" "" "" "" "" ""r""e""t""u""r""n"" ""t""a""r""g""e""t""
""
"" "" "" "" ""d""e""f"" ""f""i""n""d""_""c""l""o""s""e""s""t""_""e""v""e""n""t""s""(""s""e""l""f"","" ""s""e""c""o""n""d""_""e""v""e""n""t"","" ""f""o""u""n""d""_""e""v""e""n""t""s""_""d""i""c""t"","" ""f""i""r""s""t""_""t""r""i""g""g""e""r""s"","" ""s""e""c""o""n""d""_""t""r""i""g""g""e""r""s"")"":""
"" "" "" "" "" "" "" "" ""s""e""c""o""n""d""_""a""r""g""s"" ""="" ""d""i""c""t""(""(""r""o""l""e"","" ""s""e""l""f"".""t""r""i""g""g""e""r""_""o""r""_""s""e""l""f""(""t""a""r""g""e""t"","" ""s""e""c""o""n""d""_""t""r""i""g""g""e""r""s"")"")"" ""f""o""r"" ""(""r""o""l""e"","" ""t""a""r""g""e""t"")"" ""i""n"" ""s""e""c""o""n""d""_""e""v""e""n""t"".""a""r""g""s"")""
"" "" "" "" "" "" "" "" ""s""e""c""o""n""d""_""r""o""l""e""s"" ""="" ""s""e""t""(""s""e""c""o""n""d""_""a""r""g""s"".""k""e""y""s""("")"")""
""
"" "" "" "" "" "" "" "" ""f""o""r"" ""f""i""r""s""t""_""e""v""e""n""t"" ""i""n"" ""s""e""l""f"".""f""i""r""s""t"".""g""e""t""_""e""v""e""n""t""s""("")"":""
"" "" "" "" "" "" "" "" "" "" "" "" ""i""f"" ""s""e""l""f"".""m""a""p""p""i""n""g"".""g""e""t""_""s""e""c""o""n""d""(""f""i""r""s""t""_""e""v""e""n""t"".""t""r""i""g""g""e""r"")"" ""=""="" ""s""e""c""o""n""d""_""e""v""e""n""t"".""t""r""i""g""g""e""r"" ""a""n""d"" ""f""i""r""s""t""_""e""v""e""n""t"".""t""y""p""e"" ""=""="" ""s""e""c""o""n""d""_""e""v""e""n""t"".""t""y""p""e"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""f""i""r""s""t""_""a""r""g""s"" ""="" ""d""i""c""t""(""(""r""o""l""e"","" ""s""e""l""f"".""m""a""p""p""i""n""g"".""g""e""t""_""s""e""c""o""n""d""(""s""e""l""f"".""t""r""i""g""g""e""r""_""o""r""_""s""e""l""f""(""t""a""r""g""e""t"","" ""f""i""r""s""t""_""t""r""i""g""g""e""r""s"")"")"")"" ""f""o""r"" ""(""r""o""l""e"","" ""t""a""r""g""e""t"")"" ""i""n"" ""f""i""r""s""t""_""e""v""e""n""t"".""a""r""g""s"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""f""i""r""s""t""_""r""o""l""e""s"" ""="" ""s""e""t""(""f""i""r""s""t""_""a""r""g""s"".""k""e""y""s""("")"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""o""n""l""y""_""f""i""r""s""t"" ""="" ""s""e""t""(""r""o""l""e"" ""f""o""r"" ""r""o""l""e"" ""i""n"" ""f""i""r""s""t""_""r""o""l""e""s"" ""i""f"" ""f""i""r""s""t""_""a""r""g""s"".""g""e""t""(""r""o""l""e"")"" ""!""="" ""s""e""c""o""n""d""_""a""r""g""s"".""g""e""t""(""r""o""l""e"")"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""o""n""l""y""_""s""e""c""o""n""d"" ""="" ""s""e""t""(""r""o""l""e"" ""f""o""r"" ""r""o""l""e"" ""i""n"" ""s""e""c""o""n""d""_""r""o""l""e""s"" ""i""f"" ""f""i""r""s""t""_""a""r""g""s"".""g""e""t""(""r""o""l""e"")"" ""!""="" ""s""e""c""o""n""d""_""a""r""g""s"".""g""e""t""(""r""o""l""e"")"")""
""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""m""a""t""c""h"" ""="" ""(""f""i""r""s""t""_""e""v""e""n""t"".""i""d"","" ""f""i""r""s""t""_""a""r""g""s"","" ""s""e""c""o""n""d""_""a""r""g""s"","" ""o""n""l""y""_""f""i""r""s""t"","" ""o""n""l""y""_""s""e""c""o""n""d"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""s""c""o""r""e"" ""="" ""l""e""n""(""o""n""l""y""_""f""i""r""s""t"")"" ""+"" ""l""e""n""(""o""n""l""y""_""s""e""c""o""n""d"")""
""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""#"" ""X""X""X"" ""t""h""i""s"" ""i""s"" ""h""o""r""r""i""b""l""e"";"" ""w""h""a""t""'""s"" ""m""o""r""e"" ""P""y""t""h""o""n""i""c"" ""w""a""y""?""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""t""r""y"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""f""o""u""n""d""_""e""v""e""n""t""s""_""d""i""c""t""[""s""c""o""r""e""]""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""e""x""c""e""p""t"" ""K""e""y""E""r""r""o""r"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""f""o""u""n""d""_""e""v""e""n""t""s""_""d""i""c""t""[""s""c""o""r""e""]"" ""="" ""d""i""c""t""("")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""t""r""y"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""f""o""u""n""d""_""e""v""e""n""t""s""_""d""i""c""t""[""s""c""o""r""e""]""[""s""e""c""o""n""d""_""e""v""e""n""t"".""i""d""]""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""e""x""c""e""p""t"" ""K""e""y""E""r""r""o""r"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""f""o""u""n""d""_""e""v""e""n""t""s""_""d""i""c""t""[""s""c""o""r""e""]""[""s""e""c""o""n""d""_""e""v""e""n""t"".""i""d""]"" ""="" ""[""]""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""f""o""u""n""d""_""e""v""e""n""t""s""_""d""i""c""t""[""s""c""o""r""e""]""[""s""e""c""o""n""d""_""e""v""e""n""t"".""i""d""]"".""a""p""p""e""n""d""(""m""a""t""c""h"")""
""
"" "" "" "" ""d""e""f"" ""d""i""f""f""_""e""v""e""n""t""s""(""s""e""l""f"")"":""
"" "" "" "" "" "" "" "" ""s""e""c""o""n""d""_""t""r""i""g""g""e""r""s"" ""="" ""d""i""c""t""(""(""e""v""e""n""t"".""i""d"","" ""e""v""e""n""t"".""t""r""i""g""g""e""r"")"" ""f""o""r"" ""e""v""e""n""t"" ""i""n"" ""s""e""l""f"".""s""e""c""o""n""d"".""g""e""t""_""e""v""e""n""t""s""("")"")""
"" "" "" "" "" "" "" "" ""f""i""r""s""t""_""t""r""i""g""g""e""r""s"" ""="" ""d""i""c""t""(""(""e""v""e""n""t"".""i""d"","" ""e""v""e""n""t"".""t""r""i""g""g""e""r"")"" ""f""o""r"" ""e""v""e""n""t"" ""i""n"" ""s""e""l""f"".""f""i""r""s""t"".""g""e""t""_""e""v""e""n""t""s""("")"")""
""
"" "" "" "" "" "" "" "" ""f""o""u""n""d""_""f""i""r""s""t""_""i""d""s"" ""="" ""s""e""t""("")""
"" "" "" "" "" "" "" "" ""f""o""u""n""d""_""s""e""c""o""n""d""_""i""d""s"" ""="" ""s""e""t""("")""
""
"" "" "" "" "" "" "" "" ""f""o""u""n""d""_""e""v""e""n""t""s""_""d""i""c""t"" ""="" ""d""i""c""t""("")""
""
"" "" "" "" "" "" "" "" ""#"" ""f""i""r""s""t"" ""p""a""s""s"","" ""c""o""l""l""e""c""t"" ""e""x""a""c""t"" ""m""a""t""c""h""e""s""
"" "" "" "" "" "" "" "" ""f""o""r"" ""e""v""e""n""t"" ""i""n"" ""s""e""l""f"".""s""e""c""o""n""d"".""g""e""t""_""e""v""e""n""t""s""("")"":""
"" "" "" "" "" "" "" "" "" "" "" "" ""s""e""l""f"".""f""i""n""d""_""c""l""o""s""e""s""t""_""e""v""e""n""t""s""(""e""v""e""n""t"","" ""f""o""u""n""d""_""e""v""e""n""t""s""_""d""i""c""t"","" ""f""i""r""s""t""_""t""r""i""g""g""e""r""s"","" ""s""e""c""o""n""d""_""t""r""i""g""g""e""r""s"")""
""
"" "" "" "" "" "" "" "" ""#"" ""X""X""X"" ""P""y""t""h""o""n""i""z""e""
"" "" "" "" "" "" "" "" ""f""o""r"" ""s""c""o""r""e"" ""i""n"" ""s""o""r""t""e""d""(""f""o""u""n""d""_""e""v""e""n""t""s""_""d""i""c""t"".""k""e""y""s""("")"")"":""
"" "" "" "" "" "" "" "" "" "" "" "" ""f""o""r"" ""s""e""c""o""n""d""_""e""v""e""n""t""_""i""d"" ""i""n"" ""f""o""u""n""d""_""e""v""e""n""t""s""_""d""i""c""t""[""s""c""o""r""e""]"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""i""f"" ""n""o""t"" ""s""e""c""o""n""d""_""e""v""e""n""t""_""i""d"" ""i""n"" ""f""o""u""n""d""_""s""e""c""o""n""d""_""i""d""s"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""f""o""r"" ""m""a""t""c""h"" ""i""n"" ""f""o""u""n""d""_""e""v""e""n""t""s""_""d""i""c""t""[""s""c""o""r""e""]""[""s""e""c""o""n""d""_""e""v""e""n""t""_""i""d""]"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""f""i""r""s""t""_""e""v""e""n""t""_""i""d"","" ""f""i""r""s""t""_""a""r""g""s"","" ""s""e""c""o""n""d""_""a""r""g""s"","" ""o""n""l""y""_""f""i""r""s""t"","" ""o""n""l""y""_""s""e""c""o""n""d"" ""="" ""m""a""t""c""h""
""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""i""f"" ""n""o""t"" ""f""i""r""s""t""_""e""v""e""n""t""_""i""d"" ""i""n"" ""f""o""u""n""d""_""f""i""r""s""t""_""i""d""s"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""f""o""u""n""d""_""f""i""r""s""t""_""i""d""s"".""a""d""d""(""f""i""r""s""t""_""e""v""e""n""t""_""i""d"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""f""o""u""n""d""_""s""e""c""o""n""d""_""i""d""s"".""a""d""d""(""s""e""c""o""n""d""_""e""v""e""n""t""_""i""d"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""s""e""l""f"".""m""a""p""p""i""n""g"".""a""d""d""(""f""i""r""s""t""_""e""v""e""n""t""_""i""d"","" ""s""e""c""o""n""d""_""e""v""e""n""t""_""i""d"")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""f""o""r"" ""r""o""l""e"" ""i""n"" ""o""n""l""y""_""f""i""r""s""t"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""f""i""r""s""t""_""t""e""x""t"" ""="" ""s""e""l""f"".""f""i""r""s""t""_""t""e""x""t""b""o""u""n""d""s""[""s""e""l""f"".""m""a""p""p""i""n""g"".""g""e""t""_""f""i""r""s""t""(""f""i""r""s""t""_""a""r""g""s""[""r""o""l""e""]"")""]"".""g""e""t""_""t""e""x""t""("")""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""i""f"" ""r""o""l""e"" ""i""n"" ""o""n""l""y""_""s""e""c""o""n""d"":""
"" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""s""e""l""f"".""a""d""d""_""c""h""a""n""g""e""d""(""s""e""c""o""n""d""_""e""v""e""n""t""_""i""d"","" ""'""C""h""a""n""g""e""d"" ""r""o""l""e"" ""%""s"" ""(""f""r""o""m"" ""%""s"" 